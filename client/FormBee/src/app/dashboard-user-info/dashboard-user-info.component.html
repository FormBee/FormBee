<h1 class="name-text">Welcome, {{ name }}!</h1>

<div class="user-info">
  <div class="Section">
    <div class="usage-info">
    <p>Current API Usage</p>
    <div class="usage-bar">
      <div class="usage-progress" [style.width]="maxSubs > 0 ? currentSubs / maxSubs * 100 + '%' : '0%'"></div>
    </div>
    <p class="usage-text">{{ currentSubs }} / {{ maxSubs }}</p>
  </div>
  </div>
  <div class="Section local-host">
    <div class="usage-info">
    <p>Current Localhost Submissions</p>
    <div class="usage-bar">
      <div class="usage-progress" [style.width]="localHostMaxSubs > 0 ? localHostCurrentSubs / localHostMaxSubs * 100 + '%' : '0%'"></div>
    </div>
    <p class="usage-text">{{ localHostCurrentSubs }} / {{ localHostMaxSubs }}</p>
  </div>
  </div>
  <div class="api-key-handling email">
    <p class="email-text">Recipient Email</p>
    <input type="email" placeholder="Set email" value="{{ email }}" id="email-input">
    <div class="email-btn-container">
      <button class="api-buttons email-btn" (click)="updateEmail()">Update Email</button>
      <p *ngIf="emailValid" class="email-error">Invalid email</p>
    </div>
  </div>
  <div class="api-key-handling">
    <p>Current API Key</p>
    <p *ngIf="!apiKey">loading API key...</p>
<div class="api-key-display">
  <div class="obfu">
    <div class="obfuscation"></div>
    <p *ngIf="apiKey">{{ displayApiKey }}</p>
  </div>
  <button class="api-buttons" (click)="copyToClipboard()">Copy</button>
</div>
    <button class="api-buttons generate" (click)="newApiKey()">Generate new key</button>
  </div>

  <div class="api-key-handling returnEmails">
    <p *ngIf="googleEmail">Current return email: {{ googleEmail }}</p>
    <p *ngIf="!googleEmail">Set up return email to return an email to users who submit your forms.</p>

    <button *ngIf="googleEmail" class="api-buttons gmail-login" (click)="openReturnEmailModal()">Return email settings</button>
    <button *ngIf="!googleEmail" class="api-buttons gmail-login" (click)="openReturnEmailModal()">Sign into return email</button>
  </div>

  <div>
  </div>
</div>
<app-dashboard-return-modal *ngIf="returnEmailModal" 
  (googleEmailOutput)="googleEmail = $event" 
  (smtpHostOutput)="smtpHost = $event" 
  (smtpPortOutput)="smtpPort = $event" 
  (smtpUsernameOutput)="smtpUsername = $event" 
  (smtpPasswordOutput)="smtpPassword = $event" 
  (emailSubjectOutput)="emailSubject = $event" 
  (emailBodyOutput)="emailBody = $event" 
  (returnEmailBooleanOutput)="returnEmailBoolean = $event" 
  (returnEmailModal)="closeReturnEmailModal()" 
  [githubId]="githubId" 
  [returnEmailBoolean]="returnEmailBoolean" 
  [smtpHost]="smtpHost" 
  [smtpPort]="smtpPort" 
  [smtpUsername]="smtpUsername" 
  [smtpPassword]="smtpPassword" 
  [emailSubject]="emailSubject" 
  [emailBody]="emailBody">
</app-dashboard-return-modal>
<div class="plugins-section">
  <h2>Plugins</h2>
  <div class="plugin-grid">

    <div class="plugin-box" (click)="openTelegramModal()">
      <svg viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M128,0 C57.307,0 0,57.307 0,128 L0,128 C0,198.693 57.307,256 128,256 L128,256 C198.693,256 256,198.693 256,128 L256,128 C256,57.307 198.693,0 128,0 L128,0 Z" fill="#40B3E0"> </path> <path d="M190.2826,73.6308 L167.4206,188.8978 C167.4206,188.8978 164.2236,196.8918 155.4306,193.0548 L102.6726,152.6068 L83.4886,143.3348 L51.1946,132.4628 C51.1946,132.4628 46.2386,130.7048 45.7586,126.8678 C45.2796,123.0308 51.3546,120.9528 51.3546,120.9528 L179.7306,70.5928 C179.7306,70.5928 190.2826,65.9568 190.2826,73.6308" fill="#FFFFFF"> </path> <path d="M98.6178,187.6035 C98.6178,187.6035 97.0778,187.4595 95.1588,181.3835 C93.2408,175.3085 83.4888,143.3345 83.4888,143.3345 L161.0258,94.0945 C161.0258,94.0945 165.5028,91.3765 165.3428,94.0945 C165.3428,94.0945 166.1418,94.5735 163.7438,96.8115 C161.3458,99.0505 102.8328,151.6475 102.8328,151.6475" fill="#D2E5F1"> </path> <path d="M122.9015,168.1154 L102.0335,187.1414 C102.0335,187.1414 100.4025,188.3794 98.6175,187.6034 L102.6135,152.2624" fill="#B5CFE4"> </path> </g> </g></svg>
      <p class="plugin-text">Telegram</p>
    </div>

    <div class="plugin-box" (click)="openSlackModal()">
      <svg viewBox="-2.45 0 2452.5 2452.5" enable-background="new 0 0 2447.6 2452.5" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g clip-rule="evenodd" fill-rule="evenodd"> <path d="m897.4 0c-135.3.1-244.8 109.9-244.7 245.2-.1 135.3 109.5 245.1 244.8 245.2h244.8v-245.1c.1-135.3-109.5-245.1-244.9-245.3.1 0 .1 0 0 0m0 654h-652.6c-135.3.1-244.9 109.9-244.8 245.2-.2 135.3 109.4 245.1 244.7 245.3h652.7c135.3-.1 244.9-109.9 244.8-245.2.1-135.4-109.5-245.2-244.8-245.3z" fill="#36c5f0"></path> <path d="m2447.6 899.2c.1-135.3-109.5-245.1-244.8-245.2-135.3.1-244.9 109.9-244.8 245.2v245.3h244.8c135.3-.1 244.9-109.9 244.8-245.3zm-652.7 0v-654c.1-135.2-109.4-245-244.7-245.2-135.3.1-244.9 109.9-244.8 245.2v654c-.2 135.3 109.4 245.1 244.7 245.3 135.3-.1 244.9-109.9 244.8-245.3z" fill="#2eb67d"></path> <path d="m1550.1 2452.5c135.3-.1 244.9-109.9 244.8-245.2.1-135.3-109.5-245.1-244.8-245.2h-244.8v245.2c-.1 135.2 109.5 245 244.8 245.2zm0-654.1h652.7c135.3-.1 244.9-109.9 244.8-245.2.2-135.3-109.4-245.1-244.7-245.3h-652.7c-135.3.1-244.9 109.9-244.8 245.2-.1 135.4 109.4 245.2 244.7 245.3z" fill="#ecb22e"></path> <path d="m0 1553.2c-.1 135.3 109.5 245.1 244.8 245.2 135.3-.1 244.9-109.9 244.8-245.2v-245.2h-244.8c-135.3.1-244.9 109.9-244.8 245.2zm652.7 0v654c-.2 135.3 109.4 245.1 244.7 245.3 135.3-.1 244.9-109.9 244.8-245.2v-653.9c.2-135.3-109.4-245.1-244.7-245.3-135.4 0-244.9 109.8-244.8 245.1 0 0 0 .1 0 0" fill="#e01e5a"></path> </g> </g></svg>
      <p class="plugin-text">Slack</p>
    </div>

    <div class="plugin-box" (click)="openDiscordModal()">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z" fill="#5865f2"/>
      </svg>
      <p class="plugin-text">Discord</p>
    </div>

    <div class="plugin-box">
      <svg width="215px" height="215px" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> 
        <path d="M128.080089,-0.000183105 C135.311053,0.0131003068 142.422517,0.624138494 149.335663,1.77979593 L149.335663,1.77979593 L149.335663,76.2997796 L202.166953,23.6044907 C208.002065,27.7488446 213.460883,32.3582023 218.507811,37.3926715 C223.557281,42.4271407 228.192318,47.8867213 232.346817,53.7047992 L232.346817,53.7047992 L179.512985,106.400063 L254.227854,106.400063 C255.387249,113.29414 256,120.36111 256,127.587243 L256,127.587243 L256,127.759881 C256,134.986013 255.387249,142.066204 254.227854,148.960282 L254.227854,148.960282 L179.500273,148.960282 L232.346817,201.642324 C228.192318,207.460402 223.557281,212.919983 218.523066,217.954452 L218.523066,217.954452 L218.507811,217.954452 C213.460883,222.988921 208.002065,227.6115 202.182208,231.742607 L202.182208,231.742607 L149.335663,179.04709 L149.335663,253.5672 C142.435229,254.723036 135.323765,255.333244 128.092802,255.348499 L128.092802,255.348499 L127.907197,255.348499 C120.673691,255.333244 113.590195,254.723036 106.677048,253.5672 L106.677048,253.5672 L106.677048,179.04709 L53.8457596,231.742607 C42.1780766,223.466917 31.977435,213.278734 23.6658953,201.642324 L23.6658953,201.642324 L76.4997269,148.960282 L1.78485803,148.960282 C0.612750404,142.052729 0,134.946095 0,127.719963 L0,127.719963 L0,127.349037 C0.0121454869,125.473817 0.134939797,123.182933 0.311311815,120.812834 L0.36577283,120.099764 C0.887996182,113.428547 1.78485803,106.400063 1.78485803,106.400063 L1.78485803,106.400063 L76.4997269,106.400063 L23.6658953,53.7047992 C27.8076812,47.8867213 32.4300059,42.4403618 37.4769335,37.4193681 L37.4769335,37.4193681 L37.5023588,37.3926715 C42.5391163,32.3582023 48.0106469,27.7488446 53.8457596,23.6044907 L53.8457596,23.6044907 L106.677048,76.2997796 L106.677048,1.77979593 C113.590195,0.624138494 120.688946,0.0131003068 127.932622,-0.000183105 L127.932622,-0.000183105 L128.080089,-0.000183105 Z M128.067377,95.7600714 L127.945335,95.7600714 C118.436262,95.7600714 109.32891,97.5001809 100.910584,100.661566 C97.7553011,109.043534 96.0085811,118.129275 95.9958684,127.613685 L95.9958684,127.733184 C96.0085811,137.217594 97.7553011,146.303589 100.923296,154.685303 C109.32891,157.846943 118.436262,159.587052 127.945335,159.587052 L128.067377,159.587052 C137.576449,159.587052 146.683802,157.846943 155.089415,154.685303 C158.257411,146.290368 160.004131,137.217594 160.004131,127.733184 L160.004131,127.613685 C160.004131,118.129275 158.257411,109.043534 155.089415,100.661566 C146.683802,97.5001809 137.576449,95.7600714 128.067377,95.7600714 Z" fill="#FF4A00" fill-rule="nonzero"> </path> </g> </g>
      </svg>
      <p class="plugin-text">Zapier</p>
    </div>

  </div>
</div>

<!-- Telegram Modal -->
<div class="modal-container" *ngIf="telegramModal">
  <div class="telegram-modal">
    <button class="close-button" (click)="openTelegramModal()">&times;</button>
    <p class="plugin-title">Connect to <u (click)="teleLink()" class="clickable" style="cursor: pointer; color:rgb(225, 178, 60)">Telegram</u></p>
    <p class="plugin-description">When you connect your Telegram account, you will be able to recieve form data via messages on Telegram.</p>
    <div class="flex-row">
        <app-dashboard-telegram-widget *ngIf="telegramChat==null" [githubId]="githubId"></app-dashboard-telegram-widget>
        <div class="" *ngIf="telegramChat">
          <button class="telegram-unlink-button" (click)="unlinkTelegram()">Unlink Telegram</button>
        </div>
    </div>
    <div class="flex-row telegram-switch">
      <p class="plugin-description toggle">Enable/Disable Telegram</p>
      <label class="switch">
        <input [(ngModel)]="telegramEnabled" type="checkbox"  id="teleSwitch" (click)="teleSwitch()" />
        <span class="slider round"></span>
      </label>
    </div>
  </div>
</div>


<!-- Discord Modal -->
<div class="modal-container" *ngIf="discordModal">
  <div class="telegram-modal">
    <button class="close-button" (click)="openDiscordModal()">&times;</button>
    <p class="plugin-title">Connect to <u (click)="discordLink()" class="clickable" style="cursor: pointer; color:rgb(225, 178, 60)">Discord</u></p>
    <p class="plugin-description">When you connect your Discord channel with a webhook, you will be able to recieve form data via messages in your Discord channel.</p>
    <div class="flex-row">
      <input type="text" placeholder="Webhook URL" value="{{ discordWebhook }}" id="discord-input">
      <button class="api-buttons" (click)="saveDiscordWebhook()">Save</button>
    </div>
    <div class="flex-row telegram-switch">
      <p class="plugin-description toggle">Enable/Disable Discord</p>
      <label class="switch">
        <input [(ngModel)]="discordEnabled" type="checkbox"  id="teleSwitch" (click)="discordSwitch()" />
        <span class="slider round"></span>
      </label>
    </div>
  </div>
</div>

<!-- Slack Modal -->
<div class="modal-container" *ngIf="slackModal">
  <div class="telegram-modal">
    <button class="close-button" (click)="openSlackModal()">&times;</button>
    <p class="plugin-title">Connect to <u (click)="slackLink()" class="clickable" style="cursor: pointer; color:rgb(225, 178, 60)">Slack</u></p>
    <p class="plugin-description slack-description">When you connect your Slack channel with a webhook, you will be able to recieve form data via messages in your Slack channel.</p>
    <p class="plugin-description channelName" *ngIf="slackChannelName">Connected Channel: {{this.slackChannelName}}</p>
    <div class="flex-row">
      <button *ngIf="slackChannelName==null" class="telegram-unlink-button" (click)="connectToSlack()">Connect to slack</button>
    </div>
    <button *ngIf="slackChannelName" class="telegram-unlink-button center-align" (click)="unlinkSlack()">Unlink Slack</button>

    <div class="flex-row slack-switch">
      <p class="plugin-description toggle">Enable/Disable Slack</p>
      <label class="switch">
        <input [(ngModel)]="slackEnabled" type="checkbox"  id="slackSwitch" (click)="slackSwitch()" />
        <span class="slider round"></span>
      </label>
    </div>

  </div>
</div>
