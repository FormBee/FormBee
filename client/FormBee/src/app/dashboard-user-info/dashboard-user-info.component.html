<h1 class="name-text">Welcome, {{ name }}!</h1>

<div class="user-info">
  <div class="Section">
    <div class="usage-info">
    <p>Current API Usage</p>
    <div class="usage-bar">
      <div class="usage-progress" [style.width]="maxSubs > 0 ? currentSubs / maxSubs * 100 + '%' : '0%'"></div>
    </div>
    <p class="usage-text">{{ currentSubs }} / {{ maxSubs }}</p>
  </div>
  </div>
  <div class="Section local-host">
    <div class="usage-info">
    <p>Current Localhost Submissions</p>
    <div class="usage-bar">
      <div class="usage-progress" [style.width]="localHostMaxSubs > 0 ? localHostCurrentSubs / localHostMaxSubs * 100 + '%' : '0%'"></div>
    </div>
    <p class="usage-text">{{ localHostCurrentSubs }} / {{ localHostMaxSubs }}</p>
  </div>
  </div>
  <div class="api-key-handling email">
    <p class="email-text">Recipient Email</p>
    <input type="email" placeholder="Set email" value="{{ email }}" id="email-input">
    <div class="email-btn-container">
      <button class="api-buttons email-btn" (click)="updateEmail()">Update Email</button>
      <p *ngIf="emailValid" class="email-error">Invalid email</p>
    </div>
  </div>
  <div class="api-key-handling">
    <p>Current API Key</p>
    <p *ngIf="!apiKey">loading API key...</p>
<div class="api-key-display">
  <div class="obfu">
    <div class="obfuscation"></div>
    <p *ngIf="apiKey">{{ displayApiKey }}</p>
  </div>
  <button class="api-buttons" (click)="copyToClipboard()">Copy</button>
</div>
    <button class="api-buttons generate" (click)="newApiKey()">Generate new key</button>
  </div>

  <div class="api-key-handling returnEmails">
    <p *ngIf="googleEmail">Current return email: {{ googleEmail }}</p>
    <p *ngIf="!googleEmail">Set up return email to return an email to users who submit your forms.</p>

    <button *ngIf="googleEmail" class="api-buttons gmail-login" (click)="openReturnEmailModal()">Return email settings</button>
    <button *ngIf="!googleEmail" class="api-buttons gmail-login" (click)="openReturnEmailModal()">Sign into return email</button>
  </div>

  <div>
  </div>
</div>
<app-dashboard-return-modal *ngIf="returnEmailModal" (googleEmailOutput)="googleEmail = $event" (smtpHostOutput)="smtpHost = $event" (smtpPortOutput)="smtpPort = $event" (smtpUsernameOutput)="smtpUsername = $event" (smtpPasswordOutput)="smtpPassword = $event" (emailSubjectOutput)="emailSubject = $event" (emailBodyOutput)="emailBody = $event" (returnEmailBooleanOutput)="returnEmailBoolean = $event" (returnEmailModal)="closeReturnEmailModal()" [githubId]="githubId" [returnEmailBoolean]="returnEmailBoolean" [smtpHost]="smtpHost" [smtpPort]="smtpPort" [smtpUsername]="smtpUsername" [smtpPassword]="smtpPassword" [emailSubject]="emailSubject" [emailBody]="emailBody"></app-dashboard-return-modal>
